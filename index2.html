<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      .blueText {
        color: blue;
      }
      .boldText {
        font-weight: 600;
      }
      th,
      td,
      tr,
      table {
        border: 1px solid black;
      }
    </style>

    <title>Document</title>
  </head>
  <body>
    <section id="section1"><p>This is section 1</p></section>
    <section id="section2">
      <p>this is section</p>
      <span>orice</span>
      <p>this is section 1/2</p>
      <p>this is section 22</p>
    </section>
    <section id="section3"><p>this is section 3</p></section>

    <script>
      //   const sectionTwo = document.querySelector("#section2");
      //   sectionTwo.appendChild(h1);

      const arrayOfH1 = document.querySelectorAll("section");
      arrayOfH1.forEach((elem) => {
        const h1 = document.createElement("h1");
        h1.innerHTML = "<strong>Hello</strong> world";
        elem.appendChild(h1);
      });

      const paraf = document.querySelector("#section2 :nth-child(2)");
      paraf.classList.add("blueText");
      paraf.classList.add("boldText");
      console.log(paraf);

      let persons = [
        {
          name: "maria",
          email: "maria@gmail.com",
          id: 0,
        },
        {
          name: "ion",
          email: "ion@gmail.com",
          id: 1,
        },
        {
          name: "alex",
          email: "alex@gmail.com",
          id: 2,
        },
        {
          name: "radu",
          email: "radu@gmail.com",
          id: 3,
        },
      ];

      //   const table = document.createElement("table");
      //   const tableHeading = document.createElement("tr");
      //   const nameHeading = document.createElement("th");
      //   const emailHeading = document.createElement("th");
      //   const nameHeadingText = document.createTextNode("Name");
      //   const emailHeadingText = document.createTextNode("Email");
      //   nameHeading.appendChild(nameHeadingText);
      //   emailHeading.appendChild(emailHeadingText);
      //   tableHeading.append(nameHeading, emailHeading);
      //   table.appendChild(tableHeading);
      //   document.body.appendChild(table);

      //   console.log(persons);
      //   for (let person of persons) {
      //     console.log(person);
      //     const tableRow = document.createElement("tr");
      //     const tableRowDataName = document.createElement("td");
      //     const tableRowDataEmail = document.createElement("td");

      //     const tableRowTextName = document.createTextNode(person.name);
      //     const tableRowTextEmail = document.createTextNode(person.email);
      //     tableRowDataName.appendChild(tableRowTextName);
      //     tableRow.appendChild(tableRowDataName);
      //     tableRowDataEmail.appendChild(tableRowTextEmail);
      //     tableRow.appendChild(tableRowDataEmail);

      //     table.appendChild(tableRow);
      //   }

      const table = buildTable(persons);
      document.body.appendChild(table);
      registerEventListeners(table);
      function deleteButtonClickHandler(event) {
        console.log(event);
        console.log(event.target.parentElement);
        console.log(event.target.parentNode);
        const dataPersonId =
          event.target.parentNode.getAtribute("data-person-id");

        persons = persons.filter((person) => person.id !== dataPersonId);
        console.log(persons);
      }

      function registerEventListeners(table) {
        const deleteButtons = table.querySelectorAll("button.delete-button");
        console.log(deleteButtons);
        deleteButtons.forEach((button) => {
          button.addEventListener("click", deleteButtonClickHandler);
        });
      }
      function buildTable(persons) {
        const table = document.createElement("table");
        const tableHeading = document.createElement("tr");
        const nameHeading = document.createElement("th");
        const emailHeading = document.createElement("th");
        const actionHeading = document.createElement("th");
        const nameHeadingText = document.createTextNode("Name");
        const emailHeadingText = document.createTextNode("Email");
        const emailHeadingAction = document.createTextNode("Action");
        nameHeading.appendChild(nameHeadingText);
        emailHeading.appendChild(emailHeadingText);
        actionHeading.appendChild(emailHeadingAction);
        tableHeading.append(nameHeading, emailHeading, actionHeading);

        table.appendChild(tableHeading);

        console.log(persons);
        for (let person of persons) {
          console.log(person);
          const tableRow = document.createElement("tr");
          tableRowDataAction.setAttribute("data-person-id", person.id);
          const tableRowDataName = document.createElement("td");
          const tableRowDataEmail = document.createElement("td");
          const tableRowDataAction = document.createElement("td");
          tableRowDataAction.innerHTML =
            "<button class='delete-button'>Delete</button>";
          tableRowDataAction.setAttribute("data-person-id", person.id);

          const tableRowTextName = document.createTextNode(person.name);
          const tableRowTextEmail = document.createTextNode(person.email);
          tableRowDataName.appendChild(tableRowTextName);
          tableRow.appendChild(tableRowDataName);
          tableRowDataEmail.appendChild(tableRowTextEmail);
          tableRow.appendChild(tableRowDataEmail);
          tableRow.append(
            tableRowDataName,
            tableRowDataEmail,
            tableRowDataAction
          );
          table.appendChild(tableRow);
        }
        return table;
      }
    </script>
  </body>
</html>
